<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Embedded Widgets: Technical concept</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="tech_page">Technical concept </a></h1><p>Overview</p>
<ul>
<li><a class="el" href="tech_page.html#tech_skins">Skin System</a></li>
<li><a class="el" href="tech_page.html#tech_buildsystem">Build System</a></li>
<li><a class="el" href="tech_page.html#tech_widgets">Widgets</a><ul>
<li><a class="el" href="tech_page.html#tech_buttons">Buttons</a><ul>
<li><a class="el" href="tech_page.html#tech_qtsvgslideswitch">QtSvgSlideSwitch</a></li>
<li><a class="el" href="tech_page.html#tech_qtsvgbutton">QtSvgButton</a></li>
<li><a class="el" href="tech_page.html#tech_qtsvgtoggleswitch">QtSvgToggleSwitch</a></li>
</ul>
</li>
<li><a class="el" href="tech_page.html#tech_gauges">Gauges</a><ul>
<li><a class="el" href="tech_page.html#tech_qtsvgdialgauge">QtSvgDialGauge</a></li>
<li><a class="el" href="tech_page.html#tech_qtbasicdialgauge">QtBasicDialGauge</a></li>
</ul>
</li>
<li><a class="el" href="tech_page.html#tech_sliders">Sliders</a><ul>
<li><a class="el" href="tech_page.html#tech_qtscrollwheel">QtScrollWheel</a></li>
<li><a class="el" href="tech_page.html#tech_qslider">QSlider with Qt Style Sheets</a></li>
</ul>
</li>
<li><a class="el" href="tech_page.html#tech_advanced">Advanced Widgets</a><ul>
<li><a class="el" href="tech_page.html#tech_qt5waybutton">Qt5WayButton</a></li>
<li><a class="el" href="tech_page.html#tech_qtmultislider">QtMultiSlider</a></li>
<li><a class="el" href="tech_page.html#tech_qtscrolldial">QtScrollDial</a></li>
<li><a class="el" href="tech_page.html#tech_qtbasicgraph">QtBasicGraph</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="tech_skins">
Skin System</a></h2>
<p>The skin system is designed to support switching the current skin of a widget at run-time. The steps required to include a skin into the build system are described in the section <a class="el" href="tech_page.html#tech_buildsystem">Build System</a>. Every widget that is skinnable has a defined set of graphics. For instance, <a class="el" href="classQtSvgButton.html" title="The QtSvgButton class provides a Button, that can change the display style.">QtSvgButton</a> uses the graphics named <em>hovered</em>, <em>pressed</em> and <em>normal</em>.</p>
<p>Each skin has a unique name like e.g. <em>Beryl</em>. This skin name must be used in the source code to set a skin. The advantage of setting a skin for every widget explicitely is to support different skins simultaneously. For example, an application can have two instances of a <a class="el" href="classQtSvgButton.html" title="The QtSvgButton class provides a Button, that can change the display style.">QtSvgButton</a>, one displayed in the skin <em>Beryl</em> and the other in skin <em>BerylSquare</em>. This way the skin is easily extensible by just adding new graphics and bundling them in one Qt resource file.</p>
<p>A Qt resource file is an archive that includes several files. The files then can be accessed in all Qt classes when prefixed with a colon (read more about Qt's Resource System for further information). The skin system requires that the graphics are available as Scalable Vector Graphics (SVG) files.</p>
<p>The widget implementations use QSvgRenderer to load and render SVG files. It is worth to note that QSvgRenderer supports all static features of SVG tiny 1.2 (see also the Qt SVG module).</p>
<p>The folder structure of a resource file always looks similar to the one in <a class="el" href="classQtSvgToggleSwitch.html" title="The QtSvgToggleSwitch class provides a toggle switch.">QtSvgToggleSwitch</a>, filename beryl_svgtoggleswitch.qrc: </p>
<div class="fragment"><pre class="fragment">&lt;!DOCTYPE RCC&gt;&lt;RCC version=<span class="stringliteral">&quot;1.0&quot;</span>&gt;
&lt;qresource&gt;
    &lt;file&gt;svgtoggleswitch/Beryl/on.svg&lt;/file&gt;
    &lt;file&gt;svgtoggleswitch/Beryl/off.svg&lt;/file&gt;
&lt;/qresource&gt;
&lt;/RCC&gt;
</pre></div><p> The general naming spec looks like this: </p>
<div class="fragment"><pre class="fragment">&lt;widget-name&gt;/&lt;skin-name&gt;/&lt;file-name&gt;.svg
</pre></div><p> Skins can be created with the following steps # create a Qt resource file, e.g. beryl_svgtoggleswitch.qrc with similar content as shown above # creating the svg graphic files in the correct folder structure and SVG file name. The file names are described in the widget sections below.</p>
<h2><a class="anchor" id="tech_buildsystem">
Build System</a></h2>
<p>All skins are available in the folder <em>skins</em>. Details about the skin system can be found in the section <a class="el" href="tech_page.html#tech_skins">Skin System</a>.</p>
<p>The widgets themselves are available in the folder <em>src</em>. An example of how to integrate the widgets can be found in the folder <em>examples</em>. There are two projects, <em>Catalog</em> and <em>PatientCare</em>. The widgets are included in the qmake files (.pro files) which is shown in this examaple: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"># include pri file with source code</span>
<span class="preprocessor"></span>include(../../src/5waybutton/5waybutton.pri)

<span class="preprocessor"># add resource file with SVG graphics</span>
<span class="preprocessor">RESOURCES += ../../skins/beryl_5waybutton.qrc</span>
</pre></div><p> Now the project includes the needed files to use <a class="el" href="classQt5WayButton.html" title="The Qt5WayButton provides a button group with SVG graphics.">Qt5WayButton</a> in the code: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;Qt5WayButton&gt;</span>

<span class="comment">// later in the code</span>
<a class="code" href="classQt5WayButton.html" title="The Qt5WayButton provides a button group with SVG graphics.">Qt5WayButton</a>* button = <span class="keyword">new</span> <a class="code" href="classQt5WayButton.html" title="The Qt5WayButton provides a button group with SVG graphics.">Qt5WayButton</a>(<span class="keyword">this</span>);
button-&gt;<a class="code" href="classQt5WayButton.html#a4347f60d5b0c5e4bb7d054e06d2b9353">setSkin</a>(<span class="stringliteral">&quot;Beryl&quot;</span>);
</pre></div><h2><a class="anchor" id="tech_widgets">
Widgets</a></h2>
<p>The following sections describe the concepts and implementation of buttons, gauges, sliders and advanced widgets in detail.</p>
<h3><a class="anchor" id="tech_buttons">
Buttons</a></h3>
<p>All buttons derive from the abstract base class QAbstractButton. This way they share a common Qt style API and behave similar to QPushButton for instance. The following sections present each button.</p>
<h4><a class="anchor" id="tech_qtsvgslideswitch">
QtSvgSlideSwitch</a></h4>
<div align="center">
<img src="svgslideswitch.png" alt="svgslideswitch.png"/>
<p><strong>QtSvgSlideSwitch (Beryl skin)</strong></p></div>
<p> <a class="el" href="classQtSvgSlideSwitch.html" title="The QtSvgSlideSwitch class provides a slide switch with SVG graphics.">QtSvgSlideSwitch</a> is a SVG based button. Its appearance can be changed with <a class="el" href="classQtSvgSlideSwitch.html#ad5732c92b81b57f24768a0e3caa0fe8b">QtSvgSlideSwitch::setSkin()</a>. It reimplements the pure virtual function paintEvent() to draw the content depending on the current button state such as hovered and checked flags.</p>
<p>The following SVG files are required to create a new skin:</p>
<ul>
<li>background.svg, used as background</li>
<li>background_hover.svg, used as background if the mouse hovers over the widget</li>
<li>knob_off.svg, used as overlay to visualize the non-checked state</li>
<li>knob_on.svg, used as overlay to visualize the checked state</li>
</ul>
<h4><a class="anchor" id="tech_qtsvgbutton">
QtSvgButton</a></h4>
<div align="center">
<img src="svgbutton.png" alt="svgbutton.png"/>
<p><strong>QtSvgButton (Beryl skin)</strong></p></div>
<p> <a class="el" href="classQtSvgButton.html" title="The QtSvgButton class provides a Button, that can change the display style.">QtSvgButton</a> is a SVG based button. Its appearance can be changed with <a class="el" href="classQtSvgButton.html#a5c8f52c3df68b010670cdd6f2f55c39f">QtSvgButton::setSkin()</a>. It reimplements the pure virtual function paintEvent() to draw the current state of the button which is one of normal, hovered or pressed state.</p>
<p>The following SVG files are required to create a new skin:</p>
<ul>
<li>normal.svg, used for normal appearance</li>
<li>hovered.svg, used if the mouse is over the button</li>
<li>pressed.svg, used if the mouse is pressed</li>
</ul>
<h4><a class="anchor" id="tech_qtsvgtoggleswitch">
QtSvgToggleSwitch</a></h4>
<div align="center">
<img src="svgtoggleswitch.png" alt="svgtoggleswitch.png"/>
<p><strong>QtSvgToggleSwitch (Beryl skin)</strong></p></div>
<p> <a class="el" href="classQtSvgToggleSwitch.html" title="The QtSvgToggleSwitch class provides a toggle switch.">QtSvgToggleSwitch</a> is a SVG based button and very similar to <a class="el" href="classQtSvgButton.html" title="The QtSvgButton class provides a Button, that can change the display style.">QtSvgButton</a>. Its appearance can be changed with <a class="el" href="classQtSvgButton.html#a5c8f52c3df68b010670cdd6f2f55c39f">QtSvgButton::setSkin()</a>. <a class="el" href="classQtSvgToggleSwitch.html" title="The QtSvgToggleSwitch class provides a toggle switch.">QtSvgToggleSwitch</a> reimplements the pure virtual function paintEvent() to draw the current state of the button which is either checked or unchecked.</p>
<p>The following SVG files are required to create a new skin:</p>
<ul>
<li>off.svg, used if the button state is <em>off</em> </li>
<li>on.svg, used if the button state is <em>on</em>.</li>
</ul>
<h3><a class="anchor" id="tech_gauges">
Gauges</a></h3>
<p>The gauges are designed as read-only widgets, i.e. they do not support user input and only display a value. That's why the base class is QWidget.</p>
<h4><a class="anchor" id="tech_qtsvgdialgauge">
QtSvgDialGauge</a></h4>
<div align="center">
<img src="svgdialgauge.png" alt="svgdialgauge.png"/>
<p><strong>QtSvgDialGauge (Amperemeter skin)</strong></p></div>
<p> <a class="el" href="classQtSvgDialGauge.html" title="The QtSvgDialGauge class provides a dial gauge with SVG graphics.">QtSvgDialGauge</a> is a SVG based widget. It's appearance is basically a static image with a movable needle, for instance like a tachometer in cars. As the center of the needle varies depending on the skin the widget user first has to set the needle center in procentual values (0...1) by calling <a class="el" href="classQtSvgDialGauge.html#ae4de8f931a9892c8b5e5816758891813">QtSvgDialGauge::setNeedleOrigin()</a>.</p>
<p>The needle rotation depends on the current value and on the minimum and maximum angles. The angle range has to be set by the widget user, as it is different for every skin. The rotation itself is implemented by using Qt's transformation system.</p>
<p>The following SVG files are required to create a new skin:</p>
<ul>
<li>background.svg, the background of the gauge, always draw first</li>
<li>needle_shadow.svg, the moving needle shadow, drawn as second item</li>
<li>needle.svg, the moving needle, the third layer</li>
<li>overlay.svg, the overlay with e.g. a reflexion effect</li>
</ul>
<h4><a class="anchor" id="tech_qtbasicdialgauge">
QtBasicDialGauge</a></h4>
<div align="center">
<img src="basicdialgauge.png" alt="basicdialgauge.png"/>
<p><strong>QtBasicDialGauge (QPainter based)</strong></p></div>
<p> <a class="el" href="classQtBasicDialGauge.html" title="The QtBasicDialGauge class provides a basic dial gauge with SVG graphics.">QtBasicDialGauge</a> is an example of how to create a widget by using Qt's painting engine. It uses QPainter to draw the display without the need for SVG graphics. As the widget is very simple it can be visualized by two drawing operations: # draw the arc # draw the needle depending on the value</p>
<p>This widget does not provide the function setSkin() as it does not use graphics nor does it provide the capability to change the appearance. To support different backgrounds the paintEvent() implementation first class QWidget::paintEvent() and then draws its content.</p>
<h3><a class="anchor" id="tech_sliders">
Sliders</a></h3>
<p>All sliders in Qt usually derive from QAbstractSlider. This base class provides a common API for slider widgets. That is why the following widgets either inherid QAbstractSlider or use QSlider directly.</p>
<h4><a class="anchor" id="tech_qtscrollwheel">
QtScrollWheel</a></h4>
<div align="center">
<img src="scrollwheel.png" alt="scrollwheel.png"/>
<p><strong>QtScrollWheel (Beryl skin)</strong></p></div>
<p> <a class="el" href="classQtScrollWheel.html" title="The QtScrollWheel class provides a scroll wheel to set values.">QtScrollWheel</a> is a SVG based widget. As such the widget user has to set a skin by calling <a class="el" href="classQtScrollWheel.html#aa42a38b7988e4f6e6e1b911c3e0cc57a">QtScrollWheel::setSkin()</a>. For visualization <a class="el" href="classQtScrollWheel.html" title="The QtScrollWheel class provides a scroll wheel to set values.">QtScrollWheel</a> reimplements the paintEvent() to display the current state of the wheel. The implementation creates a turn effect to give feedback to the user when the mouse is being moved.</p>
<p>For this, the following graphics are needed in a skin:</p>
<ul>
<li>wheel_1.svg</li>
<li>wheel_2.svg</li>
<li>wheel_3.svg</li>
</ul>
<h4><a class="anchor" id="tech_qslider">
QSlider with Qt Style Sheets</a></h4>
<div align="center">
<img src="cssslider.png" alt="cssslider.png"/>
<p><strong>QSlider (Style Sheet based)</strong></p></div>
<p> QSlider is a slider widget provided by Qt itself. This example shows how to change the appearance by using Qt's Style Sheet system (CSS).</p>
<p>The following style sheet makes a QSlider appear in the Beryl skin: </p>
<div class="fragment"><pre class="fragment">QSlider::groove:vertical {
    border: qlineargradient(x1:0, y1:0, x2:1, y2:1, stop:0 #B1B1B1, stop:1 #000000);
}
QSlider::handle:vertical {
    background: qlineargradient(x1:0, y1:0, x2:0, y2:1, stop:0 #DFDFDF, stop: 0.5 #7E7E7E, stop:1 #BCBCBC);
    border: 2px solid #709E10;
    border-radius: 3px;
    width: 30px;
    height: 30px;
}
QSlider::add-page:vertical {
    background: qlineargradient(x1:0, y1:0, x2:1, y2:0, stop: 0 #C3E0CC, stop: 0.5 #7FB605, stop:1 #D8F000);
}
QSlider::sub-page:vertical {
    background: qlineargradient(x1:0, y1:0, x2:1, y2:0, stop: 0 #CCD5CC, stop: 0.5 #435A12, stop:1 #5C6700);
}
QSlider::handle:pressed {
    background: qlineargradient(x1:0, y1:0, x2:0, y2:1, stop:0 #DFDFDF, stop: 0.5 #7E7E7E, stop:1 #BCBCBC);
    border: 2px solid #D0F201;
    border-radius: 3px;
}
</pre></div><p> For further details, read the Qt documentation about using Qt Style Sheets.</p>
<h3><a class="anchor" id="tech_advanced">
Advanced Widgets</a></h3>
<h4><a class="anchor" id="tech_qt5waybutton">
Qt5WayButton</a></h4>
<div align="center">
<img src="5waybutton.png" alt="5waybutton.png"/>
<p><strong>Qt5WayButton (Beryl skin)</strong></p></div>
<p> The <a class="el" href="classQt5WayButton.html" title="The Qt5WayButton provides a button group with SVG graphics.">Qt5WayButton</a> is a custom widget composed of five push buttons. All buttons are rendered from SVG files. Internally the buttons are derived from QAbstractButton and layouted in a QGridLayout with 2 rows and 2 columns. This can be visualized as follows: </p>
<div align="center">
<img src="5waybutton-layout.png" alt="5waybutton-layout.png"/>
<p><strong>Layout of Qt5WayButton: QGridLayout of size 2x2</strong></p></div>
<p> Four buttons (left, top, right, bottom) span two cells and the center button spans all four cells.</p>
<p>The five buttons create a widget mask from the SVG graphics and set it with QWidget::setMask(). This way mouse events (click and move) are only accepted when when the mouse is over graphics.</p>
<p>The following SVG files are required to create a new skin:</p>
<ul>
<li>background.svg, background draw as first layer</li>
<li>center.svg, center button in normal state</li>
<li>center_hover.svg, center button in hovered state</li>
<li>center_pressed.svg, center button in pressed state</li>
<li>down.svg, button at the bottom in normal state</li>
<li>down_hover.svg, button at the bottom in hovered state</li>
<li>down_pressed.svg, button at the bottom in pressed state</li>
<li>left.svg, left button in normal state</li>
<li>left_hover.svg, left button in hovered state</li>
<li>left_pressed.svg, left button in pressed state</li>
<li>right.svg, right button in normal state</li>
<li>right_hover.svg, right button in hovered state</li>
<li>right_pressed.svg, right button in pressed state</li>
<li>up.svg, upper button in normal state</li>
<li>up_hover.svg, upper button in hovered state</li>
<li>up_pressed.svg, upper button in pressed state</li>
</ul>
<h4><a class="anchor" id="tech_qtmultislider">
QtMultiSlider</a></h4>
<div align="center">
<img src="multislider.png" alt="multislider.png"/>
<p><strong>QtMultiSlider (Beryl skin)</strong></p></div>
<p> <a class="el" href="classQtMultiSlider.html" title="The QtMultiSlider class provides a double slider with SVG graphics.">QtMultiSlider</a> is a SVG based progress bar with range slider. Its appearance can be changed with <a class="el" href="classQtMultiSlider.html#a887df2db2c50c7c2eb5bb33db42d4bf3">QtMultiSlider::setSkin()</a>. The <a class="el" href="classQtMultiSlider.html" title="The QtMultiSlider class provides a double slider with SVG graphics.">QtMultiSlider</a> is a vertical progress bar with a minimum and maximum value. An allowed range can be set with the upper and the lower slider. For visualization of the progress bar the <a class="el" href="classQtMultiSlider.html" title="The QtMultiSlider class provides a double slider with SVG graphics.">QtMultiSlider</a> reimplements the paintEvent() to display the current value in the valuebar.</p>
<p>If the range exceeds the upper slider the signal <em>maximumExceeded()</em> is send. If the range exceeds the lower slider the signal <em>minimumExceeded()</em> is send.</p>
<p>The following SVG files are required to create a new skin:</p>
<ul>
<li>groove.svg, the groove of the sliders</li>
<li>slider_max_hovered.svg, the upper slider in hover state</li>
<li>slider_max_pressed.svg, the upper slider in pressed state</li>
<li>slider_max_normal.svg, the upper slider in normal state</li>
<li>slider_min_hovered.svg, the lower slider in hover state</li>
<li>slider_min_pressed.svg, the lower slider in pressed state</li>
<li>slider_min_normal.svg, the lower slider in normal state</li>
<li>valuebar, the actual value bar not filled</li>
<li>valuebar_filled, the actual value bar filled</li>
<li>valuebar_top, black rectangle at the top of the valuebar</li>
<li>valuebar_bottom, black rectangle at the bottom of the valuebar</li>
</ul>
<h4><a class="anchor" id="tech_qtscrolldial">
QtScrollDial</a></h4>
<div align="center">
<img src="scrolldial.png" alt="scrolldial.png"/>
<p><strong>QtScrollDial (Beryl skin)</strong></p></div>
 <div align="center">
<img src="scrolldial-advanced.png" alt="scrolldial-advanced.png"/>
<p><strong>QtScrollDial with interaction (Beryl skin)</strong></p></div>
<p> <a class="el" href="classQtScrollDial.html" title="The QtScrollDial provides a scroll widget with SVG graphics.">QtScrollDial</a> is a SVG based dial. Its appearance can be changed with <a class="el" href="classQtScrollDial.html#a8cbcb8a760d2dc7866803772029e0b84">QtScrollDial::setSkin()</a>. The scrolldial has two different states. The first image shows the current value. The second image shows the popup window with which the current value can be changed. The new value is accepted when the popup window is closed.</p>
<p>The following SVG files are required to create a new skin:</p>
<ul>
<li>background.svg,the backround with normal state</li>
<li>background_hover.svg, the background with hover state</li>
<li>closebutton_hovered.svg, the close button with hover state</li>
<li>closebutton_normal.svg, the close button with normal state</li>
<li>closebutton_pressed.svg, the close button with pressed state</li>
<li>label.svg, the label for the top and bottom rectangle</li>
<li>popup_background.svg, the background for the popup</li>
</ul>
<h4><a class="anchor" id="tech_qtbasicgraph">
QtBasicGraph</a></h4>
<div align="center">
<img src="basicgraph.png" alt="basicgraph.png"/>
<p><strong>QtBasicGraph</strong></p></div>
<p> <a class="el" href="classQtBasicGraph.html" title="The QtBasicGraph class provides a Plot for continously streamed x/y data points.">QtBasicGraph</a> is a widget that shows a plot. The widget inherits from QAbstractItemView. For visualization <a class="el" href="classQtBasicGraph.html" title="The QtBasicGraph class provides a Plot for continously streamed x/y data points.">QtBasicGraph</a> reimplements the paintEvent() to display the current plot.</p>
<p>A QStandardItemModel with two colums and arbitray rows is used as the data source. The first column is the x value and the second column the y value.</p>
<p>The visible data area in the widget can be changed by subclassing QtRangeHandler. With a new implementation of the QtRangeHandler it is possible to define the visible area depending on the given model.</p>
<p>An example implementation of the QtRangeHandler is the FixedRangeHandler.</p>
<p>Because of the inhertance of QAbstractItemView some functions have to be implemented but actually not needed.</p>
<p>These are <br/>
 <em>visualRect()</em>, <em>scrollTo()</em>, <em>indexAt()</em>, <em>moveCursor()</em>, <em>horizontalOffset()</em>, <em>verticalOffset()</em>, <em>isIndexHidden()</em>, <em>setSelection()</em>, <em>visualRegionForSelection()</em>, <em>setRangeHandler()</em> </p>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed Nov 25 17:57:34 2009 for Embedded Widgets by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
